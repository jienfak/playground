# Jien's zshrc.
autoload -Uz compinit promptinit
compinit
promptinit
zstyle ':completion:*' menu select
setopt correct
setopt PROMPT_SUBST

shpwd() {
  echo ${${:-/${(j:/:)${(M)${(s:/:)${(D)PWD:h}}#(|.)[^.]}}/${PWD:t}}//\/~/\~} 
}

PROMPT="%F{yellow}%f%F{red}%n%f@%F{blue}%m%f:%F{yellow}$(shpwd)%f%(!.#.$)"
RPROMPT="%F{red}[%f%F{brgreen}%T%f%F{red}]%f[%F{yellow}%?%f,%F{blue}%L%f]"

#source ~/path/to/fsh/fast-syntax-highlighting.plugin.zsh
#zplugin light zdharma/fast-syntax-highlighting

echo "Trying to get any editor..."
which nvim > /dev/null
echo "Checking Neovim..."
if test $status = 0 ; then
	# Neovim.
	echo "Got Neovim."
	export EDITOR=$(which nvim)
else
	# Vim.
	which vim > /dev/null
	echo "Checking Vim..."
	if test $status = 0 ; then
		export EDITOR=$(which vim)
	else
		# Nano.
		which nano > /dev/null
		echo "Checking nano..."
		if test $status = 0 ;then
			export EDITOR=$(which nano)
		else
			export EDITOR=$(which cat)
		fi
	fi
fi
alias ed="$EDITOR"
alias edsu="sudo $EDITOR"

export VISUAL=$(which gvim)
alias edg="$VISUAL"
alias edgsu="$VISUAL"
highlight_plugin="/usr/share/zsh/plugins/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh"

echo "Trying to get highlighting plugin..."
if [ -f $highlight_plugin ]; then
	echo "Got it."
	source $highlight_plugin
else
	echo "Could not get plugin."
fi

S="$HOME/code/scripts"

# Variables.
echo "Setting variables..."
export PAGER=`which less`
export MANPAGER=$PAGER
	echo "Setting '$PAGER' colors..."
		# Less colors
		export LESS_TERMCAP_md=$(perl -e "print \"\033[1;31m\"")
		export LESS_TERMCAP_me=$(perl -e "print \"\033[0m\"")
			# Underlined
		export LESS_TERMCAP_us=$(perl -e "print \"\033[1;32m\";")
		export LESS_TERMCAP_ue=(perl -e "print \"\033[0m\"; ")
			# Service info
		export LESS_TERMCAP_so=$(perl -e "print \"\033[1;33m\";")
		export LESS_TERMCAP_se=$(perl -e "print \"\033[0m\";")
			# Blinking color
		export LESS_TERMCAP_mb=$(perl -e "print \"\033[1;32m\";")
		export LESS_TERMCAP_me=$(perl -e "print \"\033[0m\";")

# Aliases.
echo "Setting aliases..."
alias "ls"="ls --color=always"
alias "la"="ls -al --color=always"
alias "ll"="ls --color -l"
alias "sctl"="sudo systemctl"
alias "manpager"=$MANPAGER

# Functions.
echo "Setting functions..."

function helpa {
	# Check manual first.
	man $argv
	echo $status
	if test $status -eq 0 ; then
		return
	fi

	# Check info.
	info --version
	if test $status -eq 0  ; then
		info $argv
		if test $status = 0; then
			return
		fi
	fi
	
	# Check 'help' options.
	which $argv >/dev/null 2>&1
	if test $status -ne 0 ; then
		echo "help: Program '$argv' not found"
		return 
	fi
	
	eval $argv -h > /dev/null 2>&1
	if test $status -eq 0 ; then 
		eval $argv -h | manpager 2>&1
		return
	fi

	eval $argv --help > /dev/null 2>&1
	if test $status -eq 0 ; then
		eval $argv --help | manpager 2>&1
		return
	fi

	eval $argv -help > /dev/null 2>&1
	if test $status -eq 0 ; then
		eval $argv -help | manpager 2>&1
		return
	fi

	eval $argv help > /dev/null 2>&1
	if test $status -eq 0 ; then
		eval $argv help | manpager 2>&1
		return
	fi

	eval $argv > /dev/null 2>&1
	if test $status -ne 0 ; then
		eval $argv | manpager 2>&1
		return
	fi

	echo "helpa: Could not get any help!"
}

echo  FAK::Freedom:Anarchy:Knowledge::FAK
echo 'FAKYOU... why are you using zsh? Fish is better.'
